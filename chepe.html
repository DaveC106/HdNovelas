<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chepe Fortuna - Todos los Episodios</title>
    <link rel="stylesheet" href="stylesnovelas.css">
    <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
    <div class="container">
        <!-- Encabezado compacto -->
        <div class="compact-header">
            <img src="posterchepe.png" alt="Poster Chepe Fortuna" class="poster">
            <select id="episode-selector" class="episode-selector">
                <!-- Opciones se llenarán con JavaScript -->
            </select>
        </div>

        <!-- Video inmediatamente visible -->
        <div class="video-container">
            <iframe id="video-frame" width="800" height="450" src="" frameborder="0" allowfullscreen></iframe>
        </div>

        <!-- Controles mejorados -->
        <div class="controls">
            <div class="server-buttons">
                <h3>Servidor:</h3>
                <button id="streamtape-btn" class="server-btn">Streamtape</button>
                <button id="doods-btn" class="server-btn active">DoodsStream</button>
            </div>
            
            <div class="episode-navigation">
                <button id="prev-episode" class="nav-btn" disabled>
                    <span class="arrow">←</span> Anterior
                </button>
                <span id="current-episode" class="episode-number">Episodio 1</span>
                <button id="next-episode" class="nav-btn">
                    Siguiente <span class="arrow">→</span>
                </button>
            </div>
        </div>
    </div>

    <footer class="footer">
    <div class="footer-content">
      <p class="footer-logo">HD <span>Novelas</span> 2025</p>
      <div class="footer-disclaimer">
        <small>Esta página no almacena ni transmite contenido audiovisual</small>
        <small>Todos los enlaces provienen de servidores externos</small>
      </div>
      <div class="footer-links">
        <a href="#" class="footer-link">Términos</a>
        <a href="#" class="footer-link">DMCA</a>
        <a href="#" class="footer-link">Contacto</a>
      </div>
    </div>
  </footer>

    <script>
        // Cargar los datos de los episodios
        fetch('chepe.json')
            .then(response => response.json())
            .then(data => {
                const episodes = data;
                let currentEpisode = 1;
                let currentServer = 'doods'; // Cambiado a 'doods' por defecto

                // Elementos del DOM
                const videoFrame = document.getElementById('video-frame');
                const currentEpisodeDisplay = document.getElementById('current-episode');
                const prevBtn = document.getElementById('prev-episode');
                const nextBtn = document.getElementById('next-episode');
                const streamtapeBtn = document.getElementById('streamtape-btn');
                const doodsBtn = document.getElementById('doods-btn');
                const episodeSelector = document.getElementById('episode-selector');

                // Llenar el selector de episodios
                for (let i = 1; i <= 151; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Episodio ${i}`;
                    episodeSelector.appendChild(option);
                }

                // Cargar episodio inicial
                loadEpisode(currentEpisode);

                // Funciones
                function loadEpisode(episodeNumber) {
                    const episode = episodes[episodeNumber];
                    if (!episode) return;

                    const source = currentServer === 'stream' ? episode.stream : episode.doods;
                    videoFrame.src = source;
                    currentEpisodeDisplay.textContent = `Episodio ${episodeNumber}`;

                    // Actualizar selector (excluyendo el episodio actual)
                    episodeSelector.value = episodeNumber;
                    
                    // Habilitar/deshabilitar botones de navegación
                    prevBtn.disabled = episodeNumber === 1;
                    nextBtn.disabled = episodeNumber === 151;
                }

                function changeServer(server) {
                    currentServer = server;
                    loadEpisode(currentEpisode);
                    
                    // Actualizar botones activos
                    if (server === 'stream') {
                        streamtapeBtn.classList.add('active');
                        doodsBtn.classList.remove('active');
                    } else {
                        streamtapeBtn.classList.remove('active');
                        doodsBtn.classList.add('active');
                    }
                }

                // Event listeners
                prevBtn.addEventListener('click', () => {
                    if (currentEpisode > 1) {
                        currentEpisode--;
                        loadEpisode(currentEpisode);
                    }
                });

                nextBtn.addEventListener('click', () => {
                    if (currentEpisode < 151) {
                        currentEpisode++;
                        loadEpisode(currentEpisode);
                    }
                });

                streamtapeBtn.addEventListener('click', () => changeServer('stream'));
                doodsBtn.addEventListener('click', () => changeServer('doods'));

                episodeSelector.addEventListener('change', (e) => {
                    const selectedEpisode = parseInt(e.target.value);
                    if (selectedEpisode !== currentEpisode) {
                        currentEpisode = selectedEpisode;
                        loadEpisode(currentEpisode);
                    }
                });

                // Hacer que los botones de navegación funcionen con teclado
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'ArrowLeft' && !prevBtn.disabled) {
                        prevBtn.click();
                    } else if (e.key === 'ArrowRight' && !nextBtn.disabled) {
                        nextBtn.click();
                    }
                });
            })
            .catch(error => console.error('Error al cargar los episodios:', error));
    </script>
</body>
</html>